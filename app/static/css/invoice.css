/* ===== Base: ยึดขนาด A4 เสมอ ===== */
@page {
  size: A4;
  margin: 8mm;
}

/* ป้องกัน text reflow/zoom ฝั่ง iOS */
html, body {
  -webkit-text-size-adjust: 100%;
  print-color-adjust: exact;
  -webkit-print-color-adjust: exact;
}

/* ฟอนต์: ใช้ชุดเดิม แต่ลดการแตกบรรทัด */
* {
  box-sizing: border-box;
  word-break: break-word;
}

body {
  font-family: "TH Sarabun New", "Tahoma", sans-serif;
  font-size: 12pt;
  color: #0F3F7F;
  line-height: 1.2;
  margin: 0;
  background: #fff;
}

/* กรอบเอกสาร: ยึดความกว้าง “พื้นที่พิมพ์” ของ A4 */
.doc {
  /* 210mm - 2*8mm margin = 194mm */
  width: 194mm;
  margin: 0 auto;
  border: 2px solid #0F3F7F;
  border-radius: 10px;
  padding: 12px;
  background: #fff;
}

/* โครง layout ทั่วไป */
.row {
  display: flex;
  gap: 12px;
}

.col {
  flex: 1 1 0;
}

.box {
  border: 2px solid #0F3F7F;
  border-radius: 10px;
  padding: 10px;
  background: #fff;
}

.box-light {
  border: 1.5px solid #0F3F7F;
  border-radius: 10px;
  padding: 8px;
  background: #fff;
}

.title { font-weight: 700; font-size: 16pt; }
.sub   { font-size: 11pt; color: #1c5ca5; }
.right { text-align: right; }
.center{ text-align: center; }
.muted { color: #1c5ca5; font-size: 10pt; }

.mt6  { margin-top: 3px; }
.mt8  { margin-top: 4px; }
.mt10 { margin-top: 6px; }
.mt14 { margin-top: 8px; }
.mb8  { margin-bottom: 8px; }
.mb10 { margin-bottom: 10px; }

.logo { height: 18mm; width: auto; }

/* จัดคอลัมน์ซ้าย-ขวาให้สูงเท่ากัน */
.row.align-cols {
  --gap: 10px;
  --side-w: 380px;
  align-items: stretch;
  justify-content: space-between;
}
.row.align-cols .col-left  { flex: 1; margin-right: var(--gap); }
.row.align-cols .col-right { flex: 0 0 var(--side-w); }

/* ตารางสินค้า (ตายตัว ไม่ยืดตามจอ) */
.table-frame {
  border: 1.5px solid #0F3F7F;
  border-radius: 10px;
  overflow: hidden;
}

table.items {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed; /* บังคับความกว้างตามคอลัมน์ */
}

table.items thead th {
  background: #eef5ff;
  font-weight: 700;
  padding: 6px 8px;
  text-align: center;
  border-top: 1.5px solid #0F3F7F;
  border-bottom: 1.5px solid #0F3F7F;
}

table.items thead th + th { border-left: 1.5px solid #0F3F7F; }

table.items td {
  padding: 6px 8px;
  vertical-align: top;
  border: none;
}
table.items td + td { border-left: 1.5px solid #0F3F7F; }

/* ตารางสรุป */
.sumtable {
  width: 100%;
  border-collapse: collapse;
}
.sumtable td {
  border: none;
  padding: 1px 4px;
  line-height: 1.1;
}
.sumtable tr td:first-child { padding-right: 14px; }
.big-amount { font-size: 14pt; font-weight: 700; }

/* ป้องกันตัดหน้า/คอลัมน์ผิดตำแหน่ง */
.box, .box-light, .table-frame, .row, .doc, table, thead, tbody, tr, td, th {
  break-inside: avoid;
  page-break-inside: avoid;
}

/* ===== PRINT RULES: ใช้เฉพาะตอนพิมพ์ / export PDF ===== */
@media print {
  /* ตัดสิ่งที่ไม่ต้องพิมพ์ */
  .noprint, .noprint * { display: none !important; }

  html, body {
    width: 210mm;    /* ให้เบราว์เซอร์รู้ว่าหน้านี้คือ A4 */
    height: auto;
    background: #fff;
  }

  .doc {
    width: 194mm;    /* เท่าพื้นที่พิมพ์ */
    margin: 0;
    border-color: #0F3F7F;
    box-shadow: none;
    transform: none !important; /* กันสคริปต์มาปรับ scale */
  }

  th, td { padding: 4px 6px; }
  .box, .box-light { padding: 6px; }
}
