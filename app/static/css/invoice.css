    @page {
        size: A4;
        margin: 8mm;
    }

    * {
        box-sizing: border-box;
    }

    body {
        font-family: "TH Sarabun New", "Tahoma", sans-serif;
        font-size: 12pt;
        /* เดิม 15pt */
        color: #0F3F7F;
        line-height: 1.2;
        /* เพิ่ม ลดช่องไฟแนวตั้ง */
    }

    /* ให้ขอบคำนวณรวมความกว้างเสมอ */
    .col,
    .box,
    .box-light {
        box-sizing: border-box;
    }

    /* กรอบมนเหมือนเดิม */
    .box-light {
        border: 1px solid #ddd;
        border-radius: 8px;
        /* ✅ มน */
        padding: 8px 10px;
        background: #fff;
    }

    /* จัดกริดให้คอลัมน์ขวากว้างเท่ากับกล่องสรุปยอด */
    .row.align-cols {
        --gap: 10px;
        --side-w: 380px;
        display: flex;
        align-items: stretch;
        justify-content: space-between;
    }

    .row.align-cols .col-left {
        flex: 1;
        margin-right: var(--gap);
    }

    .row.align-cols .col-right {
        .row.align-cols .col-right {
            display: flex;
        }

        .row.align-cols .col-right>.box {
            flex: 1 1 auto;
            display: flex;
            flex-direction: column;
        }
    }

    /* (ตัวเลือก) ทำให้ .box กับ .box-light ดูหนาเส้นขอบเท่ากัน */
    .box,
    .box-light {
        border: 1px solid #ddd;
        border-radius: 4px;
        padding: 8px 10px;
    }

    .doc {
        border: 2px solid #0F3F7F;
        border-radius: 10px;
        padding: 12px;
    }

    .row {
        display: flex;
        gap: 12px;
    }

    .col {
        flex: 1;
    }

    .box {
        border: 2px solid #0F3F7F;
        border-radius: 10px;
        padding: 10px;
    }

    .box-light {
        border: 1.5px solid #0F3F7F;
        border-radius: 10px;
        padding: 8px;
    }

    .title {
        font-weight: 700;
        font-size: 16pt;
    }

    .sub {
        font-size: 11pt;
        color: #1c5ca5;
    }

    .right {
        text-align: right;
    }

    .center {
        text-align: center;
    }

    .muted {
        color: #1c5ca5;
        font-size: 10pt;
    }

    .mt6 {
        margin-top: 3px;
    }

    .mt10 {
        margin-top: 6px;
    }

    .mt14 {
        margin-top: 8px;
    }

    .mb6 {
        margin-bottom: 6px;
    }

    .mb8 {
        margin-bottom: 8px;
    }

    .mb10 {
        margin-bottom: 10px;
    }

    /* กันไว้ เผื่อมี mt6 บนตารางจากของเดิม */
    .table-frame .items {
        margin-top: 0 !important;
    }

    .logo {
        height: 70px;
    }

    /* กรอบนอกตารางสินค้า: ไม่มีเส้นบน */
    .table-frame {
        border: 1.5px solid #0F3F7F;
        border-radius: 10px;
        /* เดิมมีแค่มุมล่าง */
        overflow: hidden;
        /* ให้หัวตารางถูกครอบตามมุมโค้ง */
    }

    table.items thead th {
        background: #eef5ff;
        font-weight: 700;
        padding: 6px 8px;
        text-align: center;
        border-top: none;
        /* เดิมมีเส้นบน */
        border-bottom: 1.5px solid #0F3F7F;
        /* มุมบนไม่ต้องโค้ง ปล่อยให้กรอบจัดการ */
        border-top-left-radius: 0;
        border-top-right-radius: 0;
    }

    /* ตารางภายใน */
    table.items {
        width: 100%;
        border-collapse: collapse;
    }

    /* หัวตาราง: สร้างเส้นบน + มุมโค้ง */
    table.items th {
        background: #eef5ff;
        font-weight: 700;
        padding: 6px 8px;
        text-align: center;

        /* เส้นบนหัวตาราง = เส้นบนของกรอบ */
        border-top: 1.5px solid #0F3F7F;
        border-bottom: 1.5px solid #0F3F7F;
        /* เส้นใต้หัวตาราง */
    }

    /* เส้นแนวตั้งแบ่งคอลัมน์ในหัวตาราง */
    table.items th+th {
        border-left: 1.5px solid #0F3F7F;
    }

    .table-frame .items {
        margin-top: 0 !important;
    }

    /* มุมโค้งบน */
    table.items th:first-child {
        border-top-left-radius: 10px;
    }

    table.items th:last-child {
        border-top-right-radius: 10px;
    }

    /* ข้อมูล: ไม่มีเส้นบน/ล่าง แต่มีเส้นแนวตั้ง */
    table.items td {
        padding: 6px 8px;
        vertical-align: top;
        border: none;
    }

    table.items td+td {
        border-left: 1.5px solid #0F3F7F;
    }

    th {
        background: #eef5ff;
        font-weight: 700;
    }

    .no-border {
        border: none !important;
    }

    .sumtable td {
        padding: 2px 6px;
        /* ปรับ padding แนวตั้ง/แนวนอน */
        line-height: 1.2;
        /* ลดความสูงบรรทัด */
    }

    .sumtable {
        border-collapse: collapse;
    }

    /* แยก selector ปกติ (ห้ามซ้อนใน CSS ปกติ) */
    .sumtable td {
        border: none;
        padding: 1px 4px;
        /* เดิม 2px 6px */
        line-height: 1.1;
        /* เดิม 1.2 */
    }

    .sumtable tr td:first-child {
        padding-right: 14px;
    }

    .big-amount {
        font-size: 14pt;
        font-weight: 700;
    }

    /* ไม่พิมพ์ปุ่มและทุกอย่างภายใน .noprint */
    @media print {

        .noprint,
        .noprint * {
            display: none !important;
        }

        body {
            font-size: 13pt;
            -webkit-print-color-adjust: exact;
            print-color-adjust: exact;
        }

        .doc {
            padding: 6mm;
            box-shadow: none;
        }

        th,
        td {
            padding: 4px 6px;
        }

        .box,
        .box-light {
            padding: 6px;
        }
    }

    /* ---------- Header (PDF-safe, no-JS) ---------- */

    /* ให้บล็อกหัวกระดาษจัดวางด้วย flex/grid เพื่อคุมระยะคงที่ */
    .doc .row.header {
        display: grid;
        grid-template-columns: 1fr 1fr;
        align-items: start;
        column-gap: 16px;
    }

    /* คอลัมน์ซ้าย (โลโก้ + ที่อยู่บริษัท) */
    .doc .header-left .logo {
        width: 90px;
        height: auto;
        display: inline-block;
    }

    .doc .header-left .muted {
        line-height: 1.25;
        white-space: normal;
        /* ป้องกันตัวเลขทับจากการบีบบรรทัด */
    }

    /* คอลัมน์ขวา (หัวข้อเอกสาร + TAX ID + บรรทัดบริการ) */
    #header-right {
        display: flex;
        flex-direction: column;
        gap: 6px;
        line-height: 1.25;
    }

    #tax-label {
        margin-top: 10px;
    }

    #tax-id {
        line-height: 1.2;
    }

    /* ฟอนต์ไทยสม่ำเสมอ ลดปัญหาตัวเลขซ้อน (fallback metrics ต่างกัน) */
    @font-face {
        font-family: 'NotoSansThai';
        src: url('/static/fonts/NotoSansThai-Regular.ttf') format('truetype');
        font-weight: 400;
        font-style: normal;
    }

    @font-face {
        font-family: 'NotoSansThai';
        src: url('/static/fonts/NotoSansThai-Bold.ttf') format('truetype');
        font-weight: 700;
        font-style: normal;
    }

    body,
    .doc {
        font-family: 'NotoSansThai', Tahoma, 'DejaVu Sans', sans-serif;
    }

    /* กันบรรทัดโทรศัพท์ยาว ๆ ทับกัน: ให้เว้นระยะอัตโนมัติ */
    .doc .muted,
    .doc .title {
        line-height: 1.25;
    }